

## iframe
qiankun指明了iframe的四个问题（这个应该很好找），但这只是对于使用者而言，对设计者来说，iframe微前端方案还有一个真正致命的点--iframe本身。

`iframe`本质是一个黑箱，里面的很多规定是死板的（实际上是未知且死板的，你可能不知道这个规定，但可能知道了也没什么办法，比如iframe中的document在加载中和加载完成时，并不是同一个），

你很难使用某种高明的技法去解决一些问题，严格来讲，是根本做不到。

> 举个简单的例子，假设让一个iframe在`挂载->卸载->挂载`中不重新渲染，唯一的方法就是根本不卸载（iframe只要从文档中离开，哪怕没有释放，也必定会重新加载渲染）。还有弹窗，根本没有办法通过一个配置让这个弹窗弹到全局


所以在关于iframe的微前端设计中，本质都是不去触碰iframe本身，专注于数据传递和url一致（其实也很难搞），舍弃体验（也就是qiankun中说的问题）

## qiankun
直白地讲，qiankun不是一个kpi性质的东西，就我个人感觉而言，反而是一个万般无奈下的产物。它并不像是在解决什么，而是在防止什么。

> qiankun对各个子应用抱有一种莫名的敌意

由于qiankun将更多的精力放在兼容而不是体验上，与其是说qiankun是一个体验更好的iframe，不如说iframe是一个隔离得更好的qiankun，毕竟他们体验都不咋样

具体技术细节不赘述了。如果只是抱着拆小应用的想法，我不建议all in qiankun

但实际上，qiankun在市场上名声最大，声誉也好，这其实让我关注到了一个点--似乎“隔离”这个东西，需求没有，至少没有我们想的这么多

## micro-app
按他们发布的文章中说的，他们对于qiankun中的
1. 子应用改造（体验问题）
2. 沙箱隔离 （沙箱问题）
不太满意，所以搞出来个新东西。

简而言之，通过原型链的方式，将`document`操作隔离到`web component`中，用web component的生命周期 ，代替应用的生命周期钩子，内部还做了一些缓存的工作。这更接近组件化的模式，体验总归会好点 

请注意到一个点：用了webcomponent，那么肯定会考虑shadowRoot,但实际microapp官方并没有将shadowroot作为默认配置，

很多应用，比如说某个版本的react，在shadowroot中，会出问题，但显然react不是唯一会出问题的

我想到这里的时候还没有意识到，这其实是一个很关键的问题。


## garfish

我对这个东西本身没什么兴趣，它内部有点过于复杂了，但值得注意的是，garfish中有一个esmLoader，它为esm提供了环境变量，虽然这个方法在性能上已经不能用糟糕来形容，但至少，有人开始关注esm了。

严格来讲，虽然这只是个环境变量的功能，但esm的custom fetch思路已经初现端倪了。

## wujie
> 主要的点见前文
> wujie中的issue基本是iframe问题大赏，想了解iframe的人务必一看

wujie有一个比较特殊的点，除了初始化时主应用会往子应用做路由传递，后续只有子应用传递给主应用路由信息，实现了一个路由的解耦，虽然这不是很重要，也不会有什么问题，不过在微前端中，什么东西要解耦也是一个麻烦，因为除了纯粹的iframe，其他方案视图都不可能解耦（我说的不是dom结构）

## 总结
写得有点散乱，流水账是这样的

实际上具体问题有这几个
1. 用不用iframe。如果用，只能对一些问题睁一只眼闭一只眼
2. 用不用web component，如果用，webcomponent下的问题，无论是一些依赖的问题，还是样式的问题，怎么办，如果不用，怎么管理dom
3. 路由怎么弄